<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>LIFFè‡ªå‹•ç™¼è¨Šæ¯</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h1>æ­£åœ¨è™•ç†ä¸­...</h1>

  <script>
    async function main() {
      await liff.init({ liffId: "ä½ çš„LIFF_ID" });

      if (!liff.isLoggedIn()) {
        liff.login({
          scope: ['profile', 'chat_message.write'],  // è¦æ±‚å¿…è¦æ¬Šé™
        });
        return;
      }

      try {
        await liff.sendMessages([
          {
            type: "text",
            text: "ğŸ‘‹ å“ˆå›‰ï¼é€™æ˜¯è‡ªå‹•ç™¼é€çš„è¨Šæ¯ï¼"
          }
        ]);
        alert("è¨Šæ¯å·²æˆåŠŸç™¼é€ï¼");
        liff.closeWindow();  // æˆåŠŸå¾Œé—œé–‰ LIFF è¦–çª—
      } catch (err) {
        console.error('ç™¼é€å¤±æ•—', err);

        if (err.message && err.message.includes('access token revoked')) {
          alert('ç™»å…¥éæœŸäº†ï¼Œé‡æ–°ç™»å…¥ï¼');
          liff.logout();
          liff.login({
            scope: ['profile', 'chat_message.write'],
          });
        } else {
          alert("ç™¼é€å¤±æ•—ï¼Œè«‹é‡æ–°å˜—è©¦ï¼");
        }
      }
    }

    main();
  </script>
</body>
</html>
